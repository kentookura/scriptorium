(()=>{function $(){throw new Error("Failed pattern match")}var Jn=t=>({tag:t}),Lt=Jn("LT"),Ct=Jn("GT"),Vt=Jn("EQ");var A=(t,n)=>({tag:t,_1:n});var g=A("Nothing"),G=t=>A("Just",t);var Ne={map:t=>n=>n.tag==="Just"?A("Just",t(n._1)):g};var Dt=(t,n)=>({tag:t,_1:n}),zn=t=>Dt("Left",t),Fe=t=>Dt("Right",t);var Sr=function(t){return function(){return t}},It=function(t){return function(n){return function(){return n(t())()}}},Rr=function(t){return function(){for(;!t(););}};var Un={Applicative0:()=>zt,Bind1:()=>ui},ui={bind:It,Apply0:()=>Or},Or={apply:t=>n=>()=>{let r=t(),a=n();return zt.pure(r(a))()},Functor0:()=>si},zt={pure:Sr,Apply0:()=>Or},si={map:t=>n=>()=>{let r=n();return t(r)}};function ie(t){return new Error(t)}function fe(t){return function(){throw t}}var Pr=t=>{let n=t.MonadThrow0().Monad0(),r=n.Bind1().Apply0().Functor0().map,a=n.Applicative0().pure;return o=>t.catchError(r(Fe)(o))(s=>a(Dt("Left",s)))};var _e=function(t){return function(n){for(var r=n.length,a=new Array(r),o=0;o<r;o++)a[o]=t(n[o]);return a}};var Wn=t=>t;var sn=function(t){return function(n){return function(r){for(var a=n,o=r.length,s=o-1;s>=0;s--)a=t(r[s])(a);return a}}},kn=function(t){return function(n){return function(r){for(var a=n,o=r.length,s=0;s<o;s++)a=t(a)(r[s]);return a}}};var ht=t=>{let n=t.Apply0(),r=n.Functor0().map;return a=>o=>a.foldr(s=>{let p=o(s);return f=>n.apply(r(d=>Wn)(p))(f)})(t.pure(void 0))},vn=t=>{let n=ht(t);return r=>{let a=n(r);return o=>s=>a(s)(o)}};var Rt={foldr:t=>n=>r=>{if(r.tag==="Nothing")return n;if(r.tag==="Just")return t(r._1)(n);$()},foldl:t=>n=>r=>{if(r.tag==="Nothing")return n;if(r.tag==="Just")return t(n)(r._1);$()},foldMap:t=>n=>r=>{if(r.tag==="Nothing")return t.mempty;if(r.tag==="Just")return n(r._1);$()}};var Ie={foldr:sn,foldl:kn,foldMap:t=>{let n=t.Semigroup0().append;return r=>Ie.foldr(a=>o=>n(r(a))(o))(t.mempty)}};var ve=t=>t,Be=t=>{let n=ht(t.Applicative1());return r=>{let a=n(r);return o=>{let s=a(p=>t.parallel(o(p)));return p=>t.sequential(s(p))}}};var ct=function(t){throw new Error(t)};var lt=function(t){return t};var Et=function(){var t={},n="Pure",r="Throw",a="Catch",o="Sync",s="Async",p="Bind",f="Bracket",d="Fork",c="Sequential",u="Map",l="Apply",e="Alt",i="Cons",R="Resume",H="Release",J="Finalizer",St="Finalized",rt="Forked",pt="Fiber",Bt="Thunk";function y(D,U,at,k){this.tag=D,this._1=U,this._2=at,this._3=k}function st(D){var U=function(at,k,L){return new y(D,at,k,L)};return U.tag=D,U}function Pt(D){return new y(n,void 0)}function j(D){try{D()}catch(U){setTimeout(function(){throw U},0)}}function $t(D,U,at){try{return U(at())}catch(k){return D(k)}}function mt(D,U,at){try{return U(at)()}catch(k){return at(D(k))(),Pt}}var Y=function(){var D=1024,U=0,at=0,k=new Array(D),L=!1;function _(){var Q;for(L=!0;U!==0;)U--,Q=k[at],k[at]=void 0,at=(at+1)%D,Q();L=!1}return{isDraining:function(){return L},enqueue:function(Q){var q,et;U===D&&(et=L,_(),L=et),k[(at+U)%D]=Q,U++,L||_()}}}();function gt(D){var U={},at=0,k=0;return{register:function(L){var _=at++;L.onComplete({rethrow:!0,handler:function(Q){return function(){k--,delete U[_]}}})(),U[_]=L,k++},isEmpty:function(){return k===0},killAll:function(L,_){return function(){if(k===0)return _();var Q=0,q={};function et(v){q[v]=U[v].kill(L,function(dt){return function(){delete q[v],Q--,D.isLeft(dt)&&D.fromLeft(dt)&&setTimeout(function(){throw D.fromLeft(dt)},0),Q===0&&_()}})()}for(var Mt in U)U.hasOwnProperty(Mt)&&(Q++,et(Mt));return U={},at=0,k=0,function(v){return new y(o,function(){for(var dt in q)q.hasOwnProperty(dt)&&q[dt]()})}}}}}var V=0,z=1,X=2,Z=3,tt=4,_t=5,Jt=6;function Yt(D,U,at){var k=0,L=V,_=at,Q=null,q=null,et=null,Mt=null,v=null,dt=0,me=0,Gt=null,de=!0;function ce(C){for(var M,S,O;;)switch(M=null,S=null,O=null,L){case X:L=z;try{_=et(_),Mt===null?et=null:(et=Mt._1,Mt=Mt._2)}catch(Nt){L=_t,Q=D.left(Nt),_=null}break;case Z:D.isLeft(_)?(L=_t,Q=_,_=null):et===null?L=_t:(L=X,_=D.fromRight(_));break;case z:switch(_.tag){case p:et&&(Mt=new y(i,et,Mt)),et=_._2,L=z,_=_._1;break;case n:et===null?(L=_t,_=D.right(_._1)):(L=X,_=_._1);break;case o:L=Z,_=$t(D.left,D.right,_._1);break;case s:L=tt,_=mt(D.left,_._1,function(Nt){return function(){k===C&&(k++,Y.enqueue(function(){k===C+1&&(L=Z,_=Nt,ce(k))}))}});return;case r:L=_t,Q=D.left(_._1),_=null;break;case a:et===null?v=new y(i,_,v,q):v=new y(i,_,new y(i,new y(R,et,Mt),v,q),q),et=null,Mt=null,L=z,_=_._1;break;case f:dt++,et===null?v=new y(i,_,v,q):v=new y(i,_,new y(i,new y(R,et,Mt),v,q),q),et=null,Mt=null,L=z,_=_._1;break;case d:L=Z,M=Yt(D,U,_._2),U&&U.register(M),_._1&&M.run(),_=D.right(M);break;case c:L=z,_=ni(D,U,_._1);break}break;case _t:if(et=null,Mt=null,v===null)L=Jt,_=q||Q||_;else switch(M=v._3,O=v._1,v=v._2,O.tag){case a:q&&q!==M&&dt===0?L=_t:Q&&(L=z,_=O._2(D.fromLeft(Q)),Q=null);break;case R:q&&q!==M&&dt===0||Q?L=_t:(et=O._1,Mt=O._2,L=X,_=D.fromRight(_));break;case f:dt--,Q===null&&(S=D.fromRight(_),v=new y(i,new y(H,O._2,S),v,M),(q===M||dt>0)&&(L=z,_=O._3(S)));break;case H:v=new y(i,new y(St,_,Q),v,q),L=z,q&&q!==M&&dt===0?_=O._1.killed(D.fromLeft(q))(O._2):Q?_=O._1.failed(D.fromLeft(Q))(O._2):_=O._1.completed(D.fromRight(_))(O._2),Q=null,dt++;break;case J:dt++,v=new y(i,new y(St,_,Q),v,q),L=z,_=O._1;break;case St:dt--,L=_t,_=O._1,Q=O._2;break}break;case Jt:for(var it in Gt)Gt.hasOwnProperty(it)&&(de=de&&Gt[it].rethrow,j(Gt[it].handler(_)));Gt=null,q&&Q?setTimeout(function(){throw D.fromLeft(Q)},0):D.isLeft(_)&&de&&setTimeout(function(){if(de)throw D.fromLeft(_)},0);return;case V:L=z;break;case tt:return}}function ot(C){return function(){if(L===Jt)return de=de&&C.rethrow,C.handler(_)(),function(){};var M=me++;return Gt=Gt||{},Gt[M]=C,function(){Gt!==null&&delete Gt[M]}}}function E(C,M){return function(){if(L===Jt)return M(D.right(void 0))(),function(){};var S=ot({rethrow:!1,handler:function(){return M(D.right(void 0))}})();switch(L){case V:q=D.left(C),L=Jt,_=q,ce(k);break;case tt:q===null&&(q=D.left(C)),dt===0&&(L===tt&&(v=new y(i,new y(J,_(C)),v,q)),L=_t,_=null,Q=null,ce(++k));break;default:q===null&&(q=D.left(C)),dt===0&&(L=_t,_=null,Q=null)}return S}}function x(C){return function(){var M=ot({rethrow:!1,handler:C})();return L===V&&ce(k),M}}return{kill:E,join:x,onComplete:ot,isSuspended:function(){return L===V},run:function(){L===V&&(Y.isDraining()?ce(k):Y.enqueue(function(){ce(k)}))}}}function ei(D,U,at,k){var L=0,_={},Q=0,q={},et=new Error("[ParAff] Early exit"),Mt=null,v=t;function dt(ot,E,x){var C=E,M=null,S=null,O=0,it={},Nt,He;t:for(;;)switch(Nt=null,C.tag){case rt:if(C._3===t&&(Nt=_[C._1],it[O++]=Nt.kill(ot,function(ri){return function(){O--,O===0&&x(ri)()}})),M===null)break t;C=M._2,S===null?M=null:(M=S._1,S=S._2);break;case u:C=C._2;break;case l:case e:M&&(S=new y(i,M,S)),M=C,C=C._1;break}if(O===0)x(D.right(void 0))();else for(He=0,Nt=O;He<Nt;He++)it[He]=it[He]();return it}function me(ot,E,x){var C,M,S,O,it,Nt;D.isLeft(ot)?(C=ot,M=null):(M=ot,C=null);t:for(;;){if(S=null,O=null,it=null,Nt=null,Mt!==null)return;if(E===null){k(C||M)();return}if(E._3!==t)return;switch(E.tag){case u:C===null?(E._3=D.right(E._1(D.fromRight(M))),M=E._3):E._3=C;break;case l:if(S=E._1._3,O=E._2._3,C){if(E._3=C,it=!0,Nt=Q++,q[Nt]=dt(et,C===S?E._2:E._1,function(){return function(){delete q[Nt],it?it=!1:x===null?me(C,null,null):me(C,x._1,x._2)}}),it){it=!1;return}}else{if(S===t||O===t)return;M=D.right(D.fromRight(S)(D.fromRight(O))),E._3=M}break;case e:if(S=E._1._3,O=E._2._3,S===t&&D.isLeft(O)||O===t&&D.isLeft(S))return;if(S!==t&&D.isLeft(S)&&O!==t&&D.isLeft(O))C=M===S?O:S,M=null,E._3=C;else if(E._3=M,it=!0,Nt=Q++,q[Nt]=dt(et,M===S?E._2:E._1,function(){return function(){delete q[Nt],it?it=!1:x===null?me(M,null,null):me(M,x._1,x._2)}}),it){it=!1;return}break}x===null?E=null:(E=x._1,x=x._2)}}function Gt(ot){return function(E){return function(){delete _[ot._1],ot._3=E,me(E,ot._2._1,ot._2._2)}}}function de(){var ot=z,E=at,x=null,C=null,M,S;t:for(;;)switch(M=null,S=null,ot){case z:switch(E.tag){case u:x&&(C=new y(i,x,C)),x=new y(u,E._1,t,t),E=E._2;break;case l:x&&(C=new y(i,x,C)),x=new y(l,t,E._2,t),E=E._1;break;case e:x&&(C=new y(i,x,C)),x=new y(e,t,E._2,t),E=E._1;break;default:S=L++,ot=_t,M=E,E=new y(rt,S,new y(i,x,C),t),M=Yt(D,U,M),M.onComplete({rethrow:!1,handler:Gt(E)})(),_[S]=M,U&&U.register(M)}break;case _t:if(x===null)break t;x._1===t?(x._1=E,ot=z,E=x._2,x._2=t):(x._2=E,E=x,C===null?x=null:(x=C._1,C=C._2))}for(v=E,S=0;S<L;S++)_[S].run()}function ce(ot,E){Mt=D.left(ot);var x;for(var C in q)if(q.hasOwnProperty(C)){x=q[C];for(C in x)x.hasOwnProperty(C)&&x[C]()}q=null;var M=dt(ot,v,E);return function(S){return new y(s,function(O){return function(){for(var it in M)M.hasOwnProperty(it)&&M[it]();return Pt}})}}return de(),function(ot){return new y(s,function(E){return function(){return ce(ot,E)}})}}function ni(D,U,at){return new y(s,function(k){return function(){return ei(D,U,at,k)}})}return y.EMPTY=t,y.Pure=st(n),y.Throw=st(r),y.Catch=st(a),y.Sync=st(o),y.Async=st(s),y.Bind=st(p),y.Bracket=st(f),y.Fork=st(d),y.Seq=st(c),y.ParMap=st(u),y.ParApply=st(l),y.ParAlt=st(e),y.Fiber=Yt,y.Supervisor=gt,y.Scheduler=Y,y.nonCanceler=Pt,y}(),nt=Et.Pure,dn=Et.Throw;function Wr(t){return function(n){return Et.Catch(t,n)}}function De(t){return function(n){return n.tag===Et.Pure.tag?Et.Pure(t(n._1)):Et.Bind(n,function(r){return Et.Pure(t(r))})}}function b(t){return function(n){return Et.Bind(t,n)}}function kr(t){return function(n){return Et.Fork(t,n)}}var N=Et.Sync;function vr(t){return function(n){return Et.ParMap(t,n)}}function Br(t){return function(n){return Et.ParApply(t,n)}}var Ge=Et.Async;function Gr(t){return function(n){return function(r){return Et.Bracket(t,n,r)}}}function Vr(t,n){return function(){return Et.Fiber(t,null,n)}}var bi=function(){function t(r,a){return r===0&&typeof setImmediate<"u"?setImmediate(a):setTimeout(a,r)}function n(r,a){return r===0&&typeof clearImmediate<"u"?clearImmediate(a):clearTimeout(a)}return function(r,a){return Et.Async(function(o){return function(){var s=t(a,o(r()));return function(){return Et.Sync(function(){return r(n(a,s))})}}})}}(),Ve=Et.Seq;var Li={map:vr},Ci={map:De},qe=kr(!0),Ai={isLeft:t=>{if(t.tag==="Left")return!0;if(t.tag==="Right")return!1;$()},fromLeft:t=>{if(t.tag==="Left")return t._1;if(t.tag==="Right")return ct("unsafeFromLeft: Right");$()},fromRight:t=>{if(t.tag==="Right")return t._1;if(t.tag==="Left")return ct("unsafeFromRight: Left");$()},left:zn,right:Fe};var Mi={apply:Br,Functor0:()=>Li};var Gn={Applicative0:()=>xe,Bind1:()=>Ei},Ei={bind:b,Apply0:()=>jr},jr={apply:t=>n=>b(t)(r=>b(n)(a=>xe.pure(r(a)))),Functor0:()=>Ci},xe={pure:nt,Apply0:()=>jr};var Kr=t=>n=>Gr(nt(void 0))({killed:r=>a=>t,failed:r=>a=>t,completed:r=>a=>t})(r=>n);var Yr=t=>Ge(n=>{let r=t.join(n);return()=>{let a=r();return(()=>{let o=N(a);return s=>o})()}});var cn=t=>n=>b(N(n.isSuspended))(r=>r?N((()=>{let a=n.kill(t,o=>()=>void 0);return()=>(a(),void 0)})()):Ge(a=>{let o=n.kill(t,a);return()=>{let s=o();return(()=>{let p=N(s);return f=>p})()}}));var Ni={throwError:dn,Monad0:()=>Gn},Fi={catchError:Wr,MonadThrow0:()=>Ni},wi=Pr(Fi);var Ii=t=>n=>{let r=Vr(Ai,b(wi(n))(a=>N(t(a))));return()=>{let a=r();return a.run(),a}},ln=t=>n=>{let r=Ii(t)(n);return()=>(r(),void 0)};var fn={parallel:lt,sequential:Ve,Monad0:()=>Gn,Applicative1:()=>pn},pn={pure:t=>nt(t),Apply0:()=>Mi};var Xr={tailRecM:t=>{let n=r=>b(t(r))(a=>{if(a.tag==="Done")return nt(a._1);if(a.tag==="Loop")return n(a._1);$()});return n},Monad0:()=>Gn};var Zr=(()=>{let t=nt(void 0);return n=>t})();var ta=function(t){return function(n){return t===n}};var ea=ta;var na=ta;var Ke={eq:na};var jn={eq:ea};function Xt(t,n,r){return t==null?n:r(t)}var aa=function(t){return function(n){return function(r){return function(a){return function(o){return a<o?t:a===o?n:r}}}}};var oa=aa;var ia=aa;var ee={compare:ia(Lt)(Vt)(Ct),Eq0:()=>Ke};var Ut={compare:oa(Lt)(Vt)(Ct),Eq0:()=>jn};var $n=function(t){return function(n){return function(){return n[t]}}},tl=$n("children"),qi=$n("firstElementChild"),xi=$n("lastElementChild"),el=$n("childElementCount");function ua(t){return function(n){return function(){return n.querySelector(t)}}}var sa=t=>{let n=ua(t);return r=>{let a=n(r);return()=>{let o=a();return Xt(o,g,G)}}};function mn(t){return function(){return function(n){return t(n)()}}}function da(t){return function(n){return function(r){return function(a){return function(){return a.addEventListener(t,n,r)}}}}}function ca(t){return function(n){return function(r){return function(a){return function(){return a.removeEventListener(t,n,r)}}}}}var Se=function(){return window};var Kn=t=>({tag:t}),Yn=Kn("Loading"),Ri=Kn("Interactive"),Oi=Kn("Complete");var pa=t=>t==="loading"?A("Just",Yn):t==="interactive"?A("Just",Ri):t==="complete"?A("Just",Oi):g;function $a(t){return function(){return t.readyState}}var ga=t=>{let n=$a(t);return()=>{let r=n();return(()=>{let a=pa(r);if(a.tag==="Nothing")return Yn;if(a.tag==="Just")return a._1;$()})()}};function Zn(t,n,r){var a=Object.prototype.toString.call(r);return a.indexOf("[object HTML")===0&&a.indexOf("Element]")===a.length-8?n(r):t}function Ye(t){return function(){return t.document}}var Ui=t=>b(N((()=>{let n=sa(t);return()=>{let r=Se(),a=Ye(r)();return n(a)()}})()))(n=>nt((()=>{if(n.tag==="Just")return Zn(g,G,n._1);if(n.tag==="Nothing")return g;$()})())),Da=ln(t=>{if(t.tag==="Left")return fe(t._1);if(t.tag==="Right")return()=>void 0;$()}),Hi=Ge(t=>{let n=It(It(Se)(Ye))(ga);return()=>{if(n().tag==="Loading"){let a=Se(),o=mn(p=>t(Dt("Right",void 0)))();da("DOMContentLoaded")(o)(!1)(a)();let s=N(ca("DOMContentLoaded")(o)(!1)(a));return p=>s}return t(Dt("Right",void 0))(),Zr}}),ya=b(Hi)(()=>b(Ui("body"))(t=>{let n=dn(ie("Could not find body"));if(t.tag==="Nothing")return n;if(t.tag==="Just")return nt(t._1);$()}));var er=function(t){return function(){return{value:t}}};var ba=function(t){return function(){return t.value}},nr=function(t){return function(n){return function(){var r=t(n.value);return n.value=r.state,r.value}}};var ne=(t,n)=>({tag:t,_1:n});var Ta=t=>ne("Done",t);var La={tailRecM:t=>n=>{let r=It(t(n))(er);return()=>{let a=r();Rr(()=>{let s=a.value;if(s.tag==="Loop"){let p=t(s._1)();return a.value=p,!1}if(s.tag==="Done")return!0;$()})();let o=a.value;return(()=>{if(o.tag==="Done")return o._1;$()})()}},Monad0:()=>Un};var re=(t,n)=>({tag:"NonEmpty",_1:t,_2:n});var W=(t,n)=>({tag:"Tuple",_1:t,_2:n});var ar={map:t=>n=>W(n._1,t(n._2))};var he=t=>t._1;var I=(t,n,r)=>({tag:t,_1:n,_2:r});var w=I("Nil");var ae={foldr:t=>n=>{let r=ae.foldl(o=>s=>t(s)(o))(n),a=(()=>(s=>p=>{let f=s,d=p,c=!0,u;for(;c;){let l=f,e=d;if(e.tag==="Nil"){c=!1,u=l;continue}if(e.tag==="Cons"){f=I("Cons",e._1,l),d=e._2;continue}$()}return u})(w))();return o=>r(a(o))},foldl:t=>r=>a=>{let o=r,s=a,p=!0,f;for(;p;){let d=o,c=s;if(c.tag==="Nil"){p=!1,f=d;continue}if(c.tag==="Cons"){o=t(d)(c._1),s=c._2;continue}$()}return f},foldMap:t=>{let n=t.Semigroup0().append;return r=>ae.foldl(a=>{let o=n(a);return s=>o(r(s))})(t.mempty)}};var Pe=(()=>(n=>r=>{let a=n,o=r,s=!0,p;for(;s;){let f=a,d=o;if(d.tag==="Nil"){s=!1,p=f;continue}if(d.tag==="Cons"){a=I("Cons",d._1,f),o=d._2;continue}$()}return p})(w))();var _n=(t,n,r,a)=>({tag:"KickUp",_1:t,_2:n,_3:r,_4:a}),T=(t,n,r,a,o,s,p,f)=>({tag:t,_1:n,_2:r,_3:a,_4:o,_5:s,_6:p,_7:f}),K=(t,n,r,a,o,s,p)=>({tag:t,_1:n,_2:r,_3:a,_4:o,_5:s,_6:p});var P=T("Leaf");var be=t=>n=>a=>{let o=a,s=!0,p;for(;s;){let f=o;if(f.tag==="Leaf"){s=!1,p=g;continue}if(f.tag==="Two"){let d=t.compare(n)(f._2);if(d.tag==="EQ"){s=!1,p=A("Just",f._3);continue}if(d.tag==="LT"){o=f._1;continue}o=f._4;continue}if(f.tag==="Three"){let d=t.compare(n)(f._2);if(d.tag==="EQ"){s=!1,p=A("Just",f._3);continue}let c=t.compare(n)(f._5);if(c.tag==="EQ"){s=!1,p=A("Just",f._6);continue}if(d.tag==="LT"){o=f._1;continue}if(c.tag==="GT"){o=f._7;continue}o=f._4;continue}$()}return p};var ft=t=>n=>r=>{let a=t,o=n,s=r,p=!0,f;for(;p;){let d=a,c=o,u=s;if(c.tag==="Nil"){p=!1,f=u;continue}if(c.tag==="Cons"){if(c._1.tag==="TwoLeft"){a=d,o=c._2,s=T("Two",u,c._1._1,c._1._2,c._1._3);continue}if(c._1.tag==="TwoRight"){a=d,o=c._2,s=T("Two",c._1._1,c._1._2,c._1._3,u);continue}if(c._1.tag==="ThreeLeft"){a=d,o=c._2,s=T("Three",u,c._1._1,c._1._2,c._1._3,c._1._4,c._1._5,c._1._6);continue}if(c._1.tag==="ThreeMiddle"){a=d,o=c._2,s=T("Three",c._1._1,c._1._2,c._1._3,u,c._1._4,c._1._5,c._1._6);continue}if(c._1.tag==="ThreeRight"){a=d,o=c._2,s=T("Three",c._1._1,c._1._2,c._1._3,c._1._4,c._1._5,c._1._6,u);continue}$()}$()}return f},Je=t=>n=>r=>{let a=s=>p=>{let f=s,d=p,c=!0,u;for(;c;){let l=f,e=d;if(l.tag==="Nil"){c=!1,u=T("Two",e._1,e._2,e._3,e._4);continue}if(l.tag==="Cons"){if(l._1.tag==="TwoLeft"){c=!1,u=ft(t)(l._2)(T("Three",e._1,e._2,e._3,e._4,l._1._1,l._1._2,l._1._3));continue}if(l._1.tag==="TwoRight"){c=!1,u=ft(t)(l._2)(T("Three",l._1._1,l._1._2,l._1._3,e._1,e._2,e._3,e._4));continue}if(l._1.tag==="ThreeLeft"){f=l._2,d=_n(T("Two",e._1,e._2,e._3,e._4),l._1._1,l._1._2,T("Two",l._1._3,l._1._4,l._1._5,l._1._6));continue}if(l._1.tag==="ThreeMiddle"){f=l._2,d=_n(T("Two",l._1._1,l._1._2,l._1._3,e._1),e._2,e._3,T("Two",e._4,l._1._4,l._1._5,l._1._6));continue}if(l._1.tag==="ThreeRight"){f=l._2,d=_n(T("Two",l._1._1,l._1._2,l._1._3,l._1._4),l._1._5,l._1._6,T("Two",e._1,e._2,e._3,e._4));continue}$()}$()}return u};return(s=>p=>{let f=s,d=p,c=!0,u;for(;c;){let l=f,e=d;if(e.tag==="Leaf"){c=!1,u=a(l)(_n(P,n,r,P));continue}if(e.tag==="Two"){let i=t.compare(n)(e._2);if(i.tag==="EQ"){c=!1,u=ft(t)(l)(T("Two",e._1,n,r,e._4));continue}if(i.tag==="LT"){f=I("Cons",K("TwoLeft",e._2,e._3,e._4),l),d=e._1;continue}f=I("Cons",K("TwoRight",e._1,e._2,e._3),l),d=e._4;continue}if(e.tag==="Three"){let i=t.compare(n)(e._2);if(i.tag==="EQ"){c=!1,u=ft(t)(l)(T("Three",e._1,n,r,e._4,e._5,e._6,e._7));continue}let R=t.compare(n)(e._5);if(R.tag==="EQ"){c=!1,u=ft(t)(l)(T("Three",e._1,e._2,e._3,e._4,n,r,e._7));continue}if(i.tag==="LT"){f=I("Cons",K("ThreeLeft",e._2,e._3,e._4,e._5,e._6,e._7),l),d=e._1;continue}if(i.tag==="GT"){if(R.tag==="LT"){f=I("Cons",K("ThreeMiddle",e._1,e._2,e._3,e._5,e._6,e._7),l),d=e._4;continue}f=I("Cons",K("ThreeRight",e._1,e._2,e._3,e._4,e._5,e._6),l),d=e._7;continue}f=I("Cons",K("ThreeRight",e._1,e._2,e._3,e._4,e._5,e._6),l),d=e._7;continue}$()}return u})(w)},Ra=t=>n=>{let r=p=>f=>{let d=p,c=f,u=!0,l;for(;u;){let e=d,i=c;if(e.tag==="Nil"){u=!1,l=i;continue}if(e.tag==="Cons"){let R=(j,$t,mt,Y,gt,V,z,X,Z,tt)=>ft(t)(e._2)(T("Two",T("Two",j,gt,X,$t),V,Z,T("Two",mt,z,tt,Y))),H=(j,$t,mt,Y,gt,V,z,X,Z,tt)=>ft(t)(e._2)(T("Two",T("Two",j,gt,X,$t),V,Z,T("Two",mt,z,tt,Y))),J=(j,$t,mt,Y,gt,V,z,X,Z,tt)=>ft(t)(e._2)(T("Two",T("Three",j,gt,X,$t,V,Z,mt),z,tt,Y)),St=(j,$t,mt,Y,gt,V,z,X,Z,tt)=>ft(t)(e._2)(T("Two",T("Three",j,gt,X,$t,V,Z,mt),z,tt,Y)),rt=(j,$t,mt,Y,gt,V,z,X,Z,tt)=>ft(t)(e._2)(T("Two",j,gt,X,T("Three",$t,V,Z,mt,z,tt,Y))),pt=(j,$t,mt,Y,gt,V,z,X,Z,tt)=>ft(t)(e._2)(T("Two",j,gt,X,T("Three",$t,V,Z,mt,z,tt,Y))),Bt=(j,$t,mt,Y,gt,V,z,X,Z,tt,_t,Jt,Yt)=>ft(t)(e._2)(T("Three",T("Two",j,V,tt,$t),z,_t,T("Two",mt,X,Jt,Y),Z,Yt,gt)),y=(j,$t,mt,Y,gt,V,z,X,Z,tt,_t,Jt,Yt)=>ft(t)(e._2)(T("Three",T("Two",j,V,tt,$t),z,_t,T("Two",mt,X,Jt,Y),Z,Yt,gt)),st=(j,$t,mt,Y,gt,V,z,X,Z,tt,_t,Jt,Yt)=>ft(t)(e._2)(T("Three",j,V,tt,T("Two",$t,z,_t,mt),X,Jt,T("Two",Y,Z,Yt,gt))),Pt=(j,$t,mt,Y,gt,V,z,X,Z,tt,_t,Jt,Yt)=>ft(t)(e._2)(T("Three",j,V,tt,T("Two",$t,z,_t,mt),X,Jt,T("Two",Y,Z,Yt,gt)));if(i.tag==="Leaf"){if(e._1.tag==="TwoLeft"){if(e._1._3.tag==="Leaf"){u=!1,l=ft(t)(e._2)(T("Two",P,e._1._1,e._1._2,P));continue}if(e._1._3.tag==="Two"){d=e._2,c=T("Three",i,e._1._1,e._1._2,e._1._3._1,e._1._3._2,e._1._3._3,e._1._3._4);continue}if(e._1._3.tag==="Three"){u=!1,l=R(i,e._1._3._1,e._1._3._4,e._1._3._7,e._1._1,e._1._3._2,e._1._3._5,e._1._2,e._1._3._3,e._1._3._6);continue}u=!1,l=ct("The impossible happened in partial function `up`.");continue}if(e._1.tag==="TwoRight"){if(e._1._1.tag==="Leaf"){u=!1,l=ft(t)(e._2)(T("Two",P,e._1._2,e._1._3,P));continue}if(e._1._1.tag==="Two"){d=e._2,c=T("Three",e._1._1._1,e._1._1._2,e._1._1._3,e._1._1._4,e._1._2,e._1._3,i);continue}if(e._1._1.tag==="Three"){u=!1,l=H(e._1._1._1,e._1._1._4,e._1._1._7,i,e._1._1._2,e._1._1._5,e._1._2,e._1._1._3,e._1._1._6,e._1._3);continue}u=!1,l=ct("The impossible happened in partial function `up`.");continue}if(e._1.tag==="ThreeLeft"){if(e._1._6.tag==="Leaf"){if(e._1._3.tag==="Leaf"){u=!1,l=ft(t)(e._2)(T("Three",P,e._1._1,e._1._2,P,e._1._4,e._1._5,P));continue}if(e._1._3.tag==="Two"){u=!1,l=J(i,e._1._3._1,e._1._3._4,e._1._6,e._1._1,e._1._3._2,e._1._4,e._1._2,e._1._3._3,e._1._5);continue}if(e._1._3.tag==="Three"){u=!1,l=Bt(i,e._1._3._1,e._1._3._4,e._1._3._7,e._1._6,e._1._1,e._1._3._2,e._1._3._5,e._1._4,e._1._2,e._1._3._3,e._1._3._6,e._1._5);continue}u=!1,l=ct("The impossible happened in partial function `up`.");continue}if(e._1._3.tag==="Two"){u=!1,l=J(i,e._1._3._1,e._1._3._4,e._1._6,e._1._1,e._1._3._2,e._1._4,e._1._2,e._1._3._3,e._1._5);continue}if(e._1._3.tag==="Three"){u=!1,l=Bt(i,e._1._3._1,e._1._3._4,e._1._3._7,e._1._6,e._1._1,e._1._3._2,e._1._3._5,e._1._4,e._1._2,e._1._3._3,e._1._3._6,e._1._5);continue}u=!1,l=ct("The impossible happened in partial function `up`.");continue}if(e._1.tag==="ThreeMiddle"){if(e._1._1.tag==="Leaf"){if(e._1._6.tag==="Leaf"){u=!1,l=ft(t)(e._2)(T("Three",P,e._1._2,e._1._3,P,e._1._4,e._1._5,P));continue}if(e._1._6.tag==="Two"){u=!1,l=rt(e._1._1,i,e._1._6._1,e._1._6._4,e._1._2,e._1._4,e._1._6._2,e._1._3,e._1._5,e._1._6._3);continue}if(e._1._6.tag==="Three"){u=!1,l=st(e._1._1,i,e._1._6._1,e._1._6._4,e._1._6._7,e._1._2,e._1._4,e._1._6._2,e._1._6._5,e._1._3,e._1._5,e._1._6._3,e._1._6._6);continue}u=!1,l=ct("The impossible happened in partial function `up`.");continue}if(e._1._1.tag==="Two"){u=!1,l=St(e._1._1._1,e._1._1._4,i,e._1._6,e._1._1._2,e._1._2,e._1._4,e._1._1._3,e._1._3,e._1._5);continue}if(e._1._6.tag==="Two"){u=!1,l=rt(e._1._1,i,e._1._6._1,e._1._6._4,e._1._2,e._1._4,e._1._6._2,e._1._3,e._1._5,e._1._6._3);continue}if(e._1._1.tag==="Three"){u=!1,l=y(e._1._1._1,e._1._1._4,e._1._1._7,i,e._1._6,e._1._1._2,e._1._1._5,e._1._2,e._1._4,e._1._1._3,e._1._1._6,e._1._3,e._1._5);continue}if(e._1._6.tag==="Three"){u=!1,l=st(e._1._1,i,e._1._6._1,e._1._6._4,e._1._6._7,e._1._2,e._1._4,e._1._6._2,e._1._6._5,e._1._3,e._1._5,e._1._6._3,e._1._6._6);continue}u=!1,l=ct("The impossible happened in partial function `up`.");continue}if(e._1.tag==="ThreeRight"){if(e._1._1.tag==="Leaf"){if(e._1._4.tag==="Leaf"){u=!1,l=ft(t)(e._2)(T("Three",P,e._1._2,e._1._3,P,e._1._5,e._1._6,P));continue}if(e._1._4.tag==="Two"){u=!1,l=pt(e._1._1,e._1._4._1,e._1._4._4,i,e._1._2,e._1._4._2,e._1._5,e._1._3,e._1._4._3,e._1._6);continue}if(e._1._4.tag==="Three"){u=!1,l=Pt(e._1._1,e._1._4._1,e._1._4._4,e._1._4._7,i,e._1._2,e._1._4._2,e._1._4._5,e._1._5,e._1._3,e._1._4._3,e._1._4._6,e._1._6);continue}u=!1,l=ct("The impossible happened in partial function `up`.");continue}if(e._1._4.tag==="Two"){u=!1,l=pt(e._1._1,e._1._4._1,e._1._4._4,i,e._1._2,e._1._4._2,e._1._5,e._1._3,e._1._4._3,e._1._6);continue}if(e._1._4.tag==="Three"){u=!1,l=Pt(e._1._1,e._1._4._1,e._1._4._4,e._1._4._7,i,e._1._2,e._1._4._2,e._1._4._5,e._1._5,e._1._3,e._1._4._3,e._1._4._6,e._1._6);continue}u=!1,l=ct("The impossible happened in partial function `up`.");continue}u=!1,l=ct("The impossible happened in partial function `up`.");continue}if(e._1.tag==="TwoLeft"){if(e._1._3.tag==="Two"){d=e._2,c=T("Three",i,e._1._1,e._1._2,e._1._3._1,e._1._3._2,e._1._3._3,e._1._3._4);continue}if(e._1._3.tag==="Three"){u=!1,l=R(i,e._1._3._1,e._1._3._4,e._1._3._7,e._1._1,e._1._3._2,e._1._3._5,e._1._2,e._1._3._3,e._1._3._6);continue}u=!1,l=ct("The impossible happened in partial function `up`.");continue}if(e._1.tag==="TwoRight"){if(e._1._1.tag==="Two"){d=e._2,c=T("Three",e._1._1._1,e._1._1._2,e._1._1._3,e._1._1._4,e._1._2,e._1._3,i);continue}if(e._1._1.tag==="Three"){u=!1,l=H(e._1._1._1,e._1._1._4,e._1._1._7,i,e._1._1._2,e._1._1._5,e._1._2,e._1._1._3,e._1._1._6,e._1._3);continue}u=!1,l=ct("The impossible happened in partial function `up`.");continue}if(e._1.tag==="ThreeLeft"){if(e._1._3.tag==="Two"){u=!1,l=J(i,e._1._3._1,e._1._3._4,e._1._6,e._1._1,e._1._3._2,e._1._4,e._1._2,e._1._3._3,e._1._5);continue}if(e._1._3.tag==="Three"){u=!1,l=Bt(i,e._1._3._1,e._1._3._4,e._1._3._7,e._1._6,e._1._1,e._1._3._2,e._1._3._5,e._1._4,e._1._2,e._1._3._3,e._1._3._6,e._1._5);continue}u=!1,l=ct("The impossible happened in partial function `up`.");continue}if(e._1.tag==="ThreeMiddle"){if(e._1._1.tag==="Two"){u=!1,l=St(e._1._1._1,e._1._1._4,i,e._1._6,e._1._1._2,e._1._2,e._1._4,e._1._1._3,e._1._3,e._1._5);continue}if(e._1._6.tag==="Two"){u=!1,l=rt(e._1._1,i,e._1._6._1,e._1._6._4,e._1._2,e._1._4,e._1._6._2,e._1._3,e._1._5,e._1._6._3);continue}if(e._1._1.tag==="Three"){u=!1,l=y(e._1._1._1,e._1._1._4,e._1._1._7,i,e._1._6,e._1._1._2,e._1._1._5,e._1._2,e._1._4,e._1._1._3,e._1._1._6,e._1._3,e._1._5);continue}if(e._1._6.tag==="Three"){u=!1,l=st(e._1._1,i,e._1._6._1,e._1._6._4,e._1._6._7,e._1._2,e._1._4,e._1._6._2,e._1._6._5,e._1._3,e._1._5,e._1._6._3,e._1._6._6);continue}u=!1,l=ct("The impossible happened in partial function `up`.");continue}if(e._1.tag==="ThreeRight"){if(e._1._4.tag==="Two"){u=!1,l=pt(e._1._1,e._1._4._1,e._1._4._4,i,e._1._2,e._1._4._2,e._1._5,e._1._3,e._1._4._3,e._1._6);continue}if(e._1._4.tag==="Three"){u=!1,l=Pt(e._1._1,e._1._4._1,e._1._4._4,e._1._4._7,i,e._1._2,e._1._4._2,e._1._4._5,e._1._5,e._1._3,e._1._4._3,e._1._4._6,e._1._6);continue}u=!1,l=ct("The impossible happened in partial function `up`.");continue}u=!1,l=ct("The impossible happened in partial function `up`.");continue}$()}return l},a=p=>f=>{let d=p,c=f,u=!0,l;for(;u;){let e=d,i=c;if(i.tag==="Two"){if(i._1.tag==="Leaf"){if(i._4.tag==="Leaf"){u=!1,l=r(e)(P);continue}d=I("Cons",K("TwoRight",i._1,i._2,i._3),e),c=i._4;continue}d=I("Cons",K("TwoRight",i._1,i._2,i._3),e),c=i._4;continue}if(i.tag==="Three"){if(i._1.tag==="Leaf"){if(i._4.tag==="Leaf"){if(i._7.tag==="Leaf"){u=!1,l=r(I("Cons",K("TwoRight",P,i._2,i._3),e))(P);continue}d=I("Cons",K("ThreeRight",i._1,i._2,i._3,i._4,i._5,i._6),e),c=i._7;continue}d=I("Cons",K("ThreeRight",i._1,i._2,i._3,i._4,i._5,i._6),e),c=i._7;continue}d=I("Cons",K("ThreeRight",i._1,i._2,i._3,i._4,i._5,i._6),e),c=i._7;continue}u=!1,l=ct("The impossible happened in partial function `removeMaxNode`.")}return l},o=p=>{let f=p,d=!0,c;for(;d;){let u=f;if(u.tag==="Two"){if(u._4.tag==="Leaf"){d=!1,c={key:u._2,value:u._3};continue}f=u._4;continue}if(u.tag==="Three"){if(u._7.tag==="Leaf"){d=!1,c={key:u._5,value:u._6};continue}f=u._7;continue}d=!1,c=ct("The impossible happened in partial function `maxNode`.")}return c};return(p=>f=>{let d=p,c=f,u=!0,l;for(;u;){let e=d,i=c;if(i.tag==="Leaf"){u=!1,l=g;continue}if(i.tag==="Two"){let R=t.compare(n)(i._2);if(R.tag==="EQ"){if(i._4.tag==="Leaf"){u=!1,l=A("Just",W(i._3,r(e)(P)));continue}let H=o(i._1);u=!1,l=A("Just",W(i._3,a(I("Cons",K("TwoLeft",H.key,H.value,i._4),e))(i._1)));continue}if(R.tag==="LT"){d=I("Cons",K("TwoLeft",i._2,i._3,i._4),e),c=i._1;continue}d=I("Cons",K("TwoRight",i._1,i._2,i._3),e),c=i._4;continue}if(i.tag==="Three"){let R=t.compare(n)(i._5),H=t.compare(n)(i._2);if((()=>i._1.tag==="Leaf"&&i._4.tag==="Leaf"?i._7.tag==="Leaf":!1)()){if(H.tag==="EQ"){u=!1,l=A("Just",W(i._3,ft(t)(e)(T("Two",P,i._5,i._6,P))));continue}if(R.tag==="EQ"){u=!1,l=A("Just",W(i._6,ft(t)(e)(T("Two",P,i._2,i._3,P))));continue}if(H.tag==="LT"){d=I("Cons",K("ThreeLeft",i._2,i._3,i._4,i._5,i._6,i._7),e),c=i._1;continue}if(H.tag==="GT"){if(R.tag==="LT"){d=I("Cons",K("ThreeMiddle",i._1,i._2,i._3,i._5,i._6,i._7),e),c=i._4;continue}d=I("Cons",K("ThreeRight",i._1,i._2,i._3,i._4,i._5,i._6),e),c=i._7;continue}d=I("Cons",K("ThreeRight",i._1,i._2,i._3,i._4,i._5,i._6),e),c=i._7;continue}if(H.tag==="EQ"){let J=o(i._1);u=!1,l=A("Just",W(i._3,a(I("Cons",K("ThreeLeft",J.key,J.value,i._4,i._5,i._6,i._7),e))(i._1)));continue}if(R.tag==="EQ"){let J=o(i._4);u=!1,l=A("Just",W(i._6,a(I("Cons",K("ThreeMiddle",i._1,i._2,i._3,J.key,J.value,i._7),e))(i._4)));continue}if(H.tag==="LT"){d=I("Cons",K("ThreeLeft",i._2,i._3,i._4,i._5,i._6,i._7),e),c=i._1;continue}if(H.tag==="GT"){if(R.tag==="LT"){d=I("Cons",K("ThreeMiddle",i._1,i._2,i._3,i._5,i._6,i._7),e),c=i._4;continue}d=I("Cons",K("ThreeRight",i._1,i._2,i._3,i._4,i._5,i._6),e),c=i._7;continue}d=I("Cons",K("ThreeRight",i._1,i._2,i._3,i._4,i._5,i._6),e),c=i._7;continue}$()}return l})(w)},At={foldr:t=>n=>r=>{if(r.tag==="Leaf")return n;if(r.tag==="Two")return At.foldr(t)(t(r._3)(At.foldr(t)(n)(r._4)))(r._1);if(r.tag==="Three")return At.foldr(t)(t(r._3)(At.foldr(t)(t(r._6)(At.foldr(t)(n)(r._7)))(r._4)))(r._1);$()},foldl:t=>n=>r=>{if(r.tag==="Leaf")return n;if(r.tag==="Two")return At.foldl(t)(t(At.foldl(t)(n)(r._1))(r._3))(r._4);if(r.tag==="Three")return At.foldl(t)(t(At.foldl(t)(t(At.foldl(t)(n)(r._1))(r._3))(r._4))(r._6))(r._7);$()},foldMap:t=>{let n=t.Semigroup0().append;return r=>a=>{if(a.tag==="Leaf")return t.mempty;if(a.tag==="Two")return n(At.foldMap(t)(r)(a._1))(n(r(a._3))(At.foldMap(t)(r)(a._4)));if(a.tag==="Three")return n(At.foldMap(t)(r)(a._1))(n(r(a._3))(n(At.foldMap(t)(r)(a._4))(n(r(a._6))(At.foldMap(t)(r)(a._7)))));$()}}};var ir=t=>n=>r=>{let a=Ra(t)(n)(r);if(a.tag==="Nothing")return r;if(a.tag==="Just")return a._1._2;$()};var Oa=t=>n=>r=>a=>{let o=n(be(t)(r)(a));if(o.tag==="Nothing")return ir(t)(r)(a);if(o.tag==="Just")return Je(t)(r)(o._1)(a);$()};var ur=function(t){return function(){console.warn(t)}};var Te=(t,n,r)=>({tag:t,_1:n,_2:r}),Ja=t=>t,mu=t=>Te("Pure",t);var gu=t=>n=>r=>a=>o=>s=>{let p=t,f=n,d=r,c=a,u=o,l=s,e=!0,i;for(;e;){let R=p,H=f,J=d,St=c,rt=u,pt=l;if(rt.tag==="Pure"){e=!1,i=W(I("Cons",{func:R.pure(rt._1),count:pt},H),J);continue}if(rt.tag==="Lift"){e=!1,i=W(I("Cons",{func:St(rt._1),count:pt},H),J);continue}if(rt.tag==="Ap"){p=R,f=H,d=re(rt._2,I("Cons",J._1,J._2)),c=St,u=rt._1,l=pt+1|0;continue}$()}return i},za=t=>{let n=t.Apply0().apply;return r=>a=>o=>{if(r.tag==="Nil")return Dt("Left",o);if(r.tag==="Cons"){let s=n(r._1.func)(o);if(r._1.count===1)return r._2.tag==="Nil"?Dt("Left",s):za(t)(r._2)(a)(s);if(a.tag==="Nil")return Dt("Left",s);if(a.tag==="Cons")return Dt("Right",W(I("Cons",{func:s,count:r._1.count-1|0},r._2),re(a._1,a._2)));$()}$()}},Ua={map:t=>n=>Te("Ap",Te("Pure",t),n)},sr=t=>{let n=za(t);return r=>a=>(s=>{let p=s,f=!0,d;for(;f;){let c=p;if(c._2._1.tag==="Pure"){let u=n(c._1)(c._2._2)(t.pure(c._2._1._1));if(u.tag==="Left"){f=!1,d=u._1;continue}if(u.tag==="Right"){p=u._1;continue}$()}if(c._2._1.tag==="Lift"){let u=n(c._1)(c._2._2)(r(c._2._1._1));if(u.tag==="Left"){f=!1,d=u._1;continue}if(u.tag==="Right"){p=u._1;continue}$()}if(c._2._1.tag==="Ap"){p=gu(t)(c._1)(re(c._2._1._2,c._2._2))(r)(c._2._1._1)(1);continue}$()}return d})(W(w,re(a,w)))};var Ha={apply:t=>n=>Te("Ap",t,n),Functor0:()=>Ua},Qa={pure:mu,Apply0:()=>Ha},dr=sr(Qa);var Nu=function(){function t(o){return[o]}function n(o){return function(s){return[o,s]}}function r(o){return function(s){return function(p){return[o,s,p]}}}function a(o){return function(s){return o.concat(s)}}return function(o){return function(s){return function(p){return function(f){return function(d){function c(u,l){switch(l-u){case 0:return p([]);case 1:return s(t)(f(d[u]));case 2:return o(s(n)(f(d[u])))(f(d[u+1]));case 3:return o(o(s(r)(f(d[u])))(f(d[u+1])))(f(d[u+2]));default:var e=u+Math.floor((l-u)/4)*2;return o(s(a)(c(u,e)))(c(e,l))}}return c(0,d.length)}}}}}}();var xt=(t,n)=>({tag:"CatQueue",_1:t,_2:n});var va=t=>{let n=t,r=!0,a;for(;r;){let o=n;if(o._1.tag==="Nil"){if(o._2.tag==="Nil"){r=!1,a=g;continue}n=xt(Pe(o._2),w);continue}if(o._1.tag==="Cons"){r=!1,a=A("Just",W(o._1._1,xt(o._1._2,o._2)));continue}$()}return a};var kt=(t,n,r)=>({tag:t,_1:n,_2:r}),Wt=kt("CatNil");var Ot=t=>n=>{if(t.tag==="CatNil")return n;if(n.tag==="CatNil")return t;if(t.tag==="CatCons")return kt("CatCons",t._1,xt(t._2._1,I("Cons",n,t._2._2)));$()},Ou=t=>n=>r=>{let a=s=>p=>f=>{let d=s,c=p,u=f,l=!0,e;for(;l;){let i=d,R=c,H=u;if(H.tag==="Nil"){l=!1,e=R;continue}if(H.tag==="Cons"){d=i,c=i(R)(H._1),u=H._2;continue}$()}return e};return(s=>p=>{let f=s,d=p,c=!0,u;for(;c;){let l=f,e=d,i=va(l);if(i.tag==="Nothing"){c=!1,u=a(R=>H=>H(R))(n)(e);continue}if(i.tag==="Just"){f=i._1._2,d=I("Cons",t(i._1._1),e);continue}$()}return u})(r)(w)},Ba=t=>{if(t.tag==="CatNil")return g;if(t.tag==="CatCons")return A("Just",W(t._1,(()=>(()=>t._2._1.tag==="Nil"?t._2._2.tag==="Nil":!1)()?Wt:Ou(Ot)(Wt)(t._2))()));$()};var Tt=(t,n)=>({tag:"Free",_1:t,_2:n}),Kt=(t,n,r)=>({tag:t,_1:n,_2:r});var Pu=t=>{let n=t,r=!0,a;for(;r;){let o=n;if(o._1.tag==="Return"){let s=Ba(o._2);if(s.tag==="Nothing"){r=!1,a=Kt("Return",o._1._1);continue}if(s.tag==="Just"){n=(()=>{let p=s._1._1(o._1._1);return Tt(p._1,Ot(p._2)(s._1._2))})();continue}$()}if(o._1.tag==="Bind"){r=!1,a=Kt("Bind",o._1._1,s=>{let p=o._1._2(s);return Tt(p._1,Ot(p._2)(o._2))});continue}$()}return a};var Ga={map:t=>n=>Va.bind(n)(r=>Ze.pure(t(r)))},Va={bind:t=>n=>Tt(t._1,Ot(t._2)(kt("CatCons",n,xt(w,w)))),Apply0:()=>fr},fr={apply:t=>n=>Tt(t._1,Ot(t._2)(kt("CatCons",r=>Tt(n._1,Ot(n._2)(kt("CatCons",a=>Ze.pure(r(a)),xt(w,w)))),xt(w,w)))),Functor0:()=>Ga},Ze={pure:t=>Tt(Kt("Return",t),Wt),Apply0:()=>fr};var ja=t=>{let n=t.Monad0(),r=n.Bind1().Apply0().Functor0().map,a=n.Applicative0().pure;return o=>t.tailRecM(s=>{let p=Pu(s);if(p.tag==="Return")return r(Ta)(a(p._1));if(p.tag==="Bind")return r(f=>ne("Loop",p._2(f)))(o(p._1));$()})};var $r=(t,n)=>({tag:"CoyonedaF",_1:t,_2:n});var Ya=t=>{let n=ht(t)(At);return r=>a=>n(o=>a(o))(r)};var Xa=t=>t,Za=t=>t;var Le=(t,n,r)=>({tag:t,_1:n,_2:r});var yn=(t,n,r)=>({tag:t,_1:n,_2:r});var ku=function(){function t(n,r,a,o,s,p){var f,d,c,u,l,e,i;for(f=s+(p-s>>1),f-s>1&&t(n,r,o,a,s,f),p-f>1&&t(n,r,o,a,f,p),d=s,c=f,u=s;d<f&&c<p;)l=o[d],e=o[c],i=r(n(l)(e)),i>0?(a[u++]=e,++c):(a[u++]=l,++d);for(;d<f;)a[u++]=o[d++];for(;c<p;)a[u++]=o[c++]}return function(n){return function(r){return function(a){return function(){return a.length<2||t(n,r,a,a.slice(0),0,a.length),a}}}}}();var tn=function(t){return function(n){return t.length===0?n:n.length===0?t:t.concat(n)}};var Ku=function(t){return function(n){if(t<1)return[];var r=new Array(t);return r.fill(n)}},Yu=function(t){return function(n){for(var r=[],a=0,o=0;o<t;o++)r[a++]=n;return r}},ig=typeof Array.prototype.fill=="function"?Ku:Yu,ao=function(){function t(o,s){this.head=o,this.tail=s}var n={};function r(o){return function(s){return new t(o,s)}}function a(o){for(var s=[],p=0,f=o;f!==n;)s[p++]=f.head,f=f.tail;return s}return function(o){return function(s){return a(o(r)(n)(s))}}}();var oo=function(t){return function(n){return function(r){return function(a){for(var o=0,s=a.length;o<s;o++)if(r(a[o]))return t(o);return n}}}};var io=function(t){return function(n){return function(r){return function(a){if(r<0||r>=a.length)return n;var o=a.slice();return o.splice(r,1),t(o)}}}};var Xu=function(){function t(n,r,a,o,s,p){var f,d,c,u,l,e,i;for(f=s+(p-s>>1),f-s>1&&t(n,r,o,a,s,f),p-f>1&&t(n,r,o,a,f,p),d=s,c=f,u=s;d<f&&c<p;)l=o[d],e=o[c],i=r(n(l)(e)),i>0?(a[u++]=e,++c):(a[u++]=l,++d);for(;d<f;)a[u++]=o[d++];for(;c<p;)a[u++]=o[c++]}return function(n){return function(r){return function(a){var o;return a.length<2?a:(o=a.slice(0),t(n,r,o,a.slice(0),0,a.length),o)}}}}();var es=oo(G)(g);var ns=io(G)(g),uo=t=>n=>r=>{if(r.length===0)return[];let a=es(t(n))(r);if(a.tag==="Nothing")return r;if(a.tag==="Just"){let o=ns(a._1)(r);if(o.tag==="Just")return o._1;$()}$()};function Ce(t){return function(n){return t===n}}var rs=ht(zt),as=rs(Ie);var bn=t=>t;var co=()=>{let t={value:[]};return{emitter:n=>()=>{let r=t.value;return t.value=tn(r)([n]),()=>{let a=t.value;return t.value=uo(Ce)(n)(a),void 0}},listener:n=>It(()=>t.value)(as(r=>r(n)))}};var os=ht(zt)(Rt),$o=ht(xe),is=$o(ae),us=Be(fn)(ae)(ve),ss=sr(pn)(Ja),fo=$o(Rt),ds=ja(Xr),cs=t=>n=>()=>{let a=n.value.subscriptions.value;return os(bn)((()=>{let o=be(Ut)(t);if(a.tag==="Just")return o(a._1);if(a.tag==="Nothing")return g;$()})())()},en=t=>n=>b(N(()=>t.value))(r=>{if(r.tag==="Nothing")return n;if(r.tag==="Just")return N(()=>t.value=A("Just",I("Cons",n,r._1)));$()}),Tn=t=>n=>b(N(()=>t.value={initializers:w,finalizers:w}))(()=>b(N(n))(r=>b(N(()=>t.value))(a=>b(is(qe)(a.finalizers))(()=>b(us(a.initializers))(()=>nt(r)))))),Ae=ln(t=>{if(t.tag==="Left")return fe(t._1);if(t.tag==="Right")return()=>void 0;$()}),po=t=>n=>b(N(()=>n.value))(r=>N(nr(a=>({state:a+1|0,value:t(a)}))(r.fresh))),hr=t=>n=>r=>b(N(()=>n.value))(a=>$e(t)(n)(a.component.eval(Le("Query",$r(o=>A("Just",o),r),o=>g)))),$e=t=>n=>r=>ds(a=>{if(a.tag==="State")return b(N(()=>n.value))(o=>{let s=a._1(o.state);return Ce(o.state)(s._2)?nt(s._1):b(N(()=>n.value={component:o.component,state:s._2,refs:o.refs,children:o.children,childrenIn:o.childrenIn,childrenOut:o.childrenOut,selfRef:o.selfRef,handlerRef:o.handlerRef,pendingQueries:o.pendingQueries,pendingOuts:o.pendingOuts,pendingHandlers:o.pendingHandlers,rendering:o.rendering,fresh:o.fresh,subscriptions:o.subscriptions,forks:o.forks,lifecycleHandlers:o.lifecycleHandlers}))(()=>b(Tn(o.lifecycleHandlers)(t(o.lifecycleHandlers)(n)))(()=>nt(s._1)))});if(a.tag==="Subscribe")return b(po(Xa)(n))(o=>b(N(a._1(o)(s=>{let p=Ae(Ln(t)(n)(yn("Action",s)));return()=>(p(),void 0)})))(s=>b(N(()=>n.value))(p=>b(N((()=>{let f=Ne.map(Je(Ut)(o)(s));return()=>{let d=p.subscriptions.value;return p.subscriptions.value=f(d),void 0}})()))(()=>nt(a._2(o))))));if(a.tag==="Unsubscribe")return b(N(cs(a._1)(n)))(()=>nt(a._2));if(a.tag==="Lift")return a._1;if(a.tag==="ChildQuery")return b(N(()=>n.value))(o=>De(a._1._3)(Ve(a._1._1(pn)(s=>b(N(()=>s.value))(p=>hr(t)(p.selfRef)(a._1._2)))(o.children))));if(a.tag==="Raise")return b(N(()=>n.value))(o=>b(N(()=>o.handlerRef.value))(s=>b(en(o.pendingOuts)(s(a._1)))(()=>nt(a._2))));if(a.tag==="Par")return Ve(ss((()=>{let o=$e(t)(n);return dr(s=>Te("Lift",o(s)))(a._1)})()));if(a.tag==="Fork")return b(po(Za)(n))(o=>b(N(()=>n.value))(s=>b(N(()=>({value:!1})))(p=>b(qe(Kr(N(()=>{let f=s.forks.value;return s.forks.value=ir(Ut)(o)(f),p.value=!0}))($e(t)(n)(a._1))))(f=>b(N((()=>{let d=Je(Ut)(o)(f);return()=>{let c=p.value;if(!c){let u=s.forks.value;return s.forks.value=d(u),void 0}if(c)return void 0;$()}})()))(()=>nt(a._2(o)))))));if(a.tag==="Join")return b(N(()=>n.value))(o=>b(N(()=>o.forks.value))(s=>b(fo(Yr)(be(Ut)(a._1)(s)))(()=>nt(a._2))));if(a.tag==="Kill")return b(N(()=>n.value))(o=>b(N(()=>o.forks.value))(s=>b(fo(cn(ie("Cancelled")))(be(Ut)(a._1)(s)))(()=>nt(a._2))));if(a.tag==="GetRef")return b(N(()=>n.value))(o=>nt(a._2(be(ee)(a._1)(o.refs))));$()})(r),Ln=t=>n=>r=>{if(r.tag==="RefUpdate")return N(()=>{let a=n.value;return n.value={component:a.component,state:a.state,refs:Oa(ee)(o=>r._2)(r._1)(a.refs),children:a.children,childrenIn:a.childrenIn,childrenOut:a.childrenOut,selfRef:a.selfRef,handlerRef:a.handlerRef,pendingQueries:a.pendingQueries,pendingOuts:a.pendingOuts,pendingHandlers:a.pendingHandlers,rendering:a.rendering,fresh:a.fresh,subscriptions:a.subscriptions,forks:a.forks,lifecycleHandlers:a.lifecycleHandlers},void 0});if(r.tag==="Action")return b(N(()=>n.value))(a=>$e(t)(n)(a.component.eval(Le("Action",r._1,void 0))));$()};var mo=t=>n=>r=>a=>()=>{let o={value:{}},s={value:P},p={value:P},f={value:r},d={value:A("Just",w)},c={value:A("Just",w)},u={value:g},l={value:1},e={value:A("Just",P)},i={value:P};return o.value={component:t,state:t.initialState(n),refs:P,children:P,childrenIn:s,childrenOut:p,selfRef:o,handlerRef:f,pendingQueries:d,pendingOuts:c,pendingHandlers:u,rendering:g,fresh:l,subscriptions:e,forks:i,lifecycleHandlers:a},o};var ho=vn(zt)(Rt),bo=ht(xe)(ae),To=ht(zt),Lo=To(Rt),go=To(At),ps=Be(fn)(ae)(ve),_o=Ya(zt),$s=(()=>{let t=ht(zt)(Rt);return n=>r=>t(n)(r.rendering)})(),Do=()=>({value:{initializers:w,finalizers:w}}),yo=t=>()=>{let n=t.value;return t.value=g,ho(n)((()=>{let r=bo(qe);return a=>Ae(r(Pe(a)))})())()},ms=t=>{let n=It(()=>t.subscriptions.value)(Lo(go(bn)));return()=>(n(),t.subscriptions.value=g,It(()=>t.forks.value)(go((()=>{let r=cn(ie("finalized"));return a=>Ae(r(a))})()))(),t.forks.value=P)},Co=t=>n=>r=>{let a=d=>c=>u=>{let l=$e(p)(u.selfRef)(u.component.eval(Le("Initialize",void 0)));return()=>{let e=d.value;return d.value={initializers:I("Cons",b(ps(Pe(e.initializers)))(()=>b(l)(()=>N(()=>(yo(u.pendingQueries)(),yo(u.pendingOuts)())))),c),finalizers:e.finalizers},void 0}},o=d=>c=>u=>l=>()=>{let e=Do(),i=mo(l)(u)(c)(e)(),R=d.value;d.value={initializers:w,finalizers:R.finalizers};let H=i.value;return p(d)(H.selfRef)(),It(()=>i.value)(a(d)(R.initializers))(),i},s=d=>c=>u=>l=>e=>()=>{let i=u.value,R=e.pop(i),H=(()=>{if(R.tag==="Just")return()=>{u.value=R._1._2;let y=R._1._1.value,st=nt(void 0);return y.handlerRef.value=Pt=>{let j=e.output(Pt);if(j.tag==="Nothing")return st;if(j.tag==="Just")return c(j._1);$()},Ae($e(p)(y.selfRef)(y.component.eval(Le("Receive",e.input,void 0))))(),R._1._1};if(R.tag==="Nothing")return o(d)((()=>{let y=nt(void 0);return st=>{let Pt=e.output(st);if(Pt.tag==="Nothing")return y;if(Pt.tag==="Just")return c(Pt._1);$()}})())(e.input)(e.component);$()})()(),J=l.value,St=e.get(J),rt=ur("Halogen: Duplicate slot address was detected during rendering, unexpected results may occur");(()=>(()=>{if(St.tag==="Nothing")return!1;if(St.tag==="Just")return!0;$()})()?rt:()=>void 0)()();let pt=l.value;l.value=e.set(H)(pt);let Bt=H.value;if(Bt.rendering.tag==="Nothing")return fe(ie("Halogen internal error: child was not initialized in renderChild"))();if(Bt.rendering.tag==="Just")return t.renderChild(Bt.rendering._1);$()},p=d=>c=>()=>{let u=c.value,l=u.pendingHandlers.value,e=(()=>{if(l.tag==="Nothing")return!0;if(l.tag==="Just")return!1;$()})();(()=>e?()=>u.pendingHandlers.value=A("Just",w):()=>void 0)()(),u.childrenOut.value=P,u.childrenIn.value=u.children;let i=t.render((()=>{let rt=De(pt=>void 0);return pt=>Ae(en(u.pendingHandlers)(rt(Ln(p)(u.selfRef)(pt))))})())(s(d)((()=>{let rt=De(pt=>void 0);return pt=>en(u.pendingQueries)(en(u.pendingHandlers)(rt(Ln(p)(u.selfRef)(yn("Action",pt)))))})())(u.childrenIn)(u.childrenOut))(u.component.render(u.state))(u.rendering)(),R=u.childrenOut.value,H=u.childrenIn.value;_o(H)(rt=>()=>{let pt=rt.value;return $s(t.removeChild)(pt)(),f(d)(pt)()})();let J=u.selfRef.value;u.selfRef.value={component:J.component,state:J.state,refs:J.refs,children:R,childrenIn:J.childrenIn,childrenOut:J.childrenOut,selfRef:J.selfRef,handlerRef:J.handlerRef,pendingQueries:J.pendingQueries,pendingOuts:J.pendingOuts,pendingHandlers:J.pendingHandlers,rendering:A("Just",i),fresh:J.fresh,subscriptions:J.subscriptions,forks:J.forks,lifecycleHandlers:J.lifecycleHandlers};let St=La.tailRecM(rt=>()=>{let pt=u.pendingHandlers.value;u.pendingHandlers.value=A("Just",w),Lo((()=>{let y=bo(qe);return st=>Ae(y(Pe(st)))})())(pt)();let Bt=u.pendingHandlers.value;return(()=>{if(Bt.tag==="Nothing")return!1;if(Bt.tag==="Just")return Bt._1.tag==="Nil";$()})()?(u.pendingHandlers.value=g,ne("Done",void 0)):ne("Loop",void 0)})(void 0);return e?St():void 0},f=d=>c=>{let u=ms(c);return()=>{u();let l=d.value;return d.value={initializers:l.initializers,finalizers:I("Cons",$e(p)(c.selfRef)(c.component.eval(Le("Finalize",void 0))),l.finalizers)},_o(c.children)(e=>()=>{let i=e.value;return f(d)(i)()})()}};return b(N(Do))(d=>b(N(()=>({value:!1})))(c=>Tn(d)(()=>{let u=co(),l=It(o(d)(e=>N(u.listener(e)))(r)(n))(ba)();return{query:e=>b(N(()=>c.value))(i=>i?nt(g):hr(p)(l.selfRef)(e)),messages:u.emitter,dispose:Tn(d)(()=>{if(c.value)return void 0;c.value=!0,f(d)(l)();let i=l.selfRef.value;return ho(i.rendering)(t.dispose)()})}})))};var ut=(t,n,r,a)=>({tag:"Step",_1:t,_2:n,_3:r,_4:a});var vt=(t,n)=>t._3(t._2,n);var wt=t=>t._4(t._2);var _s=(t,n,r)=>({tag:"Graft",_1:t,_2:n,_3:r}),se=(t,n,r,a,o)=>({tag:t,_1:n,_2:r,_3:a,_4:o});var Ds={bimap:t=>n=>r=>_s(a=>t(r._1(a)),a=>n(r._2(a)),r._3)};var ze=t=>{let n=r=>{if(r.tag==="Text")return se("Text",r._1);if(r.tag==="Elem")return se("Elem",r._1,r._2,t._1(r._3),_e(n)(r._4));if(r.tag==="Keyed")return se("Keyed",r._1,r._2,t._1(r._3),_e(ar.map(n))(r._4));if(r.tag==="Widget")return se("Widget",t._2(r._1));if(r.tag==="Grafted")return se("Grafted",Ds.bimap(t._1)(t._2)(r._1));$()};return n(t._3)};var nn=function(){return{}};function Me(t,n){return n[t]}function Ao(t,n){return n.hasOwnProperty(t)}function Zt(t,n,r){r[t]=n}function Mo(t,n){for(var r=[],a=0;a<t.length;a++)r.push(n(a,t[a]));return r}function Eo(t,n){for(var r=0;r<t.length;r++)n(t[r])}function No(t,n){for(var r=Object.keys(t),a=0;a<r.length;a++){var o=r[a];n(o,t[o])}}function Fo(t,n,r,a,o){for(var s=[],p=t.length,f=n.length,d=0;;){if(d<p)d<f?s.push(r(d,t[d],n[d])):a(d,t[d]);else if(d<f)s.push(o(d,n[d]));else break;d++}return s}function An(t,n,r){for(var a={},o=0;o<t.length;o++){var s=t[o],p=n(s);a[p]=r(p,o,s)}return a}function Mn(t,n,r,a,o,s){for(var p={},f=0;f<n.length;f++){var d=n[f],c=r(d);t.hasOwnProperty(c)?p[c]=a(c,f,t[c],d):p[c]=s(c,f,d)}for(var c in t)c in p||o(c,t[c]);return p}function Ue(t,n){return t===n}function wo(t,n){return n.createTextNode(t)}function Io(t,n){n.textContent=t}function Lr(t,n,r){return t!=null?r.createElementNS(t,n):r.createElement(n)}function Ee(t,n,r){var a=r.childNodes.item(t)||null;a!==n&&r.insertBefore(n,a)}function En(t,n){n&&t.parentNode===n&&n.removeChild(t)}function Nn(t){return t.parentNode}function Cr(t,n,r,a){t!=null?a.setAttributeNS(t,n,r):a.setAttribute(n,r)}function Ar(t,n,r){t!=null?r.removeAttributeNS(t,n):r.removeAttribute(n)}function qo(t,n,r){return t!=null?r.hasAttributeNS(t,n):r.hasAttribute(n)}function xo(t,n,r){r.addEventListener(t,n,!1)}function So(t,n,r){r.removeEventListener(t,n,!1)}var Ro=void 0;var Er=t=>wt(t.widget),Nr=(t,n)=>{if(n.tag==="Grafted"){let r=ze(n._1);return Nr(t,r)}if(n.tag==="Widget"){let r=vt(t.widget,n._1);return ut(r._1,{build:t.build,widget:r},Nr,Er)}return Er(t),t.build(n)},Fn=t=>{let n=Nn(t.node);return En(t.node,n)},wn=(t,n)=>{if(n.tag==="Grafted"){let r=ze(n._1);return wn(t,r)}return n.tag==="Text"?t.value===n._1?ut(t.node,t,wn,Fn):(Io(n._1,t.node),ut(t.node,{build:t.build,node:t.node,value:n._1},wn,Fn)):(Fn(t),t.build(n))},rn=t=>{let n=Nn(t.node);return En(t.node,n),No(t.children,(r,a)=>wt(a)),wt(t.attrs)},an=t=>{let n=Nn(t.node);return En(t.node,n),Eo(t.children,wt),wt(t.attrs)},Oo=(t,n,r,a)=>n===a?t.tag==="Just"?r.tag==="Just"?t._1===r._1:!1:t.tag==="Nothing"?r.tag==="Nothing":!1:!1,In=(t,n)=>{if(n.tag==="Grafted"){let r=ze(n._1);return In(t,r)}if(n.tag==="Elem"){if(Oo(t.ns,t.name,n._1,n._2)){let r=()=>()=>{let a=Fo(t.children,n._4,(s,p,f)=>{let d=vt(p,f);return Ee(s,d._1,t.node),d},(s,p)=>wt(p),(s,p)=>{let f=t.build(p);return Ee(s,f._1,t.node),f}),o=vt(t.attrs,n._3);return ut(t.node,{build:t.build,node:t.node,attrs:o,ns:n._1,name:n._2,children:a},In,an)};if(t.children.length===0){if(n._4.length===0){let a=vt(t.attrs,n._3);return ut(t.node,{build:t.build,node:t.node,attrs:a,ns:n._1,name:n._2,children:t.children},In,an)}return r()()}return r()()}return an(t),t.build(n)}return an(t),t.build(n)},qn=(t,n)=>{if(n.tag==="Grafted"){let r=ze(n._1);return qn(t,r)}if(n.tag==="Keyed"){if(Oo(t.ns,t.name,n._1,n._2)){let r=n._4.length,a=o=>()=>{let s=Mn(t.children,n._4,he,(f,d,c,u)=>{let l=vt(c,u._2);return Ee(d,l._1,t.node),l},(f,d)=>wt(d),(f,d,c)=>{let u=t.build(c._2);return Ee(d,u._1,t.node),u}),p=vt(t.attrs,n._3);return ut(t.node,{build:t.build,node:t.node,attrs:p,ns:n._1,name:n._2,children:s,length:o},qn,rn)};if(t.length===0){if(r===0){let o=vt(t.attrs,n._3);return ut(t.node,{build:t.build,node:t.node,attrs:o,ns:n._1,name:n._2,children:t.children,length:0},qn,rn)}return a(r)()}return a(r)()}return rn(t),t.build(n)}return rn(t),t.build(n)},ys=(t,n,r)=>{let a=t.buildWidget(t)(r);return ut(a._1,{build:n,widget:a},Nr,Er)},hs=(t,n,r)=>{let a=wo(r,t.document);return ut(a,{build:n,node:a,value:r},wn,Fn)},bs=(t,n,r,a,o,s)=>{let p=(()=>{if(r.tag==="Nothing")return null;if(r.tag==="Just")return r._1;$()})(),f=Lr(p,a,t.document),d=An(s,he,(u,l,e)=>{let i=n(e._2);return Ee(l,i._1,f),i}),c=t.buildAttributes(f)(o);return ut(f,{build:n,node:f,attrs:c,ns:r,name:a,children:d,length:s.length},qn,rn)},Ts=(t,n,r,a,o,s)=>{let p=(()=>{if(r.tag==="Nothing")return null;if(r.tag==="Just")return r._1;$()})(),f=Lr(p,a,t.document),d=Mo(s,(u,l)=>{let e=n(l);return Ee(u,e._1,f),e}),c=t.buildAttributes(f)(o);return ut(f,{build:n,node:f,attrs:c,ns:r,name:a,children:d},In,an)},xn=t=>{let n=r=>{if(r.tag==="Text")return hs(t,n,r._1);if(r.tag==="Elem")return Ts(t,n,r._1,r._2,r._3,r._4);if(r.tag==="Keyed")return bs(t,n,r._1,r._2,r._3,r._4);if(r.tag==="Widget")return ys(t,n,r._1);if(r.tag==="Grafted"){let a=ze(r._1);return n(a)}$()};return n};function Jo(t){return typeof t}var Fs=Array.isArray||function(t){return Object.prototype.toString.call(t)==="[object Array]"};function Fr(t,n,r,a){return r in a?n(a[r]):t}function zo(t){return function(n){var r=[];for(var a in n)hasOwnProperty.call(n,a)&&r.push(t(a)(n[a]));return r}}var X1=Object.keys||zo(function(t){return function(){return t}});var Uo=(t,n)=>({tag:t,_1:n});var qs=(t,n)=>qo(null,t,n)?Ar(null,t,n):Jo(Me(t,n))==="string"?Zt(t,"",n):t==="rowSpan"?Zt(t,1,n):t==="colSpan"?Zt(t,1,n):Zt(t,Ro,n),Ho=t=>{if(t.tag==="Attribute")return t._1.tag==="Just"?"attr/"+(t._1._1+(":"+t._2)):"attr/:"+t._2;if(t.tag==="Property")return"prop/"+t._1;if(t.tag==="Handler")return"handler/"+t._1;if(t.tag==="Ref")return"ref";$()};var Qo=t=>n=>{let r=s=>{let p=Fr(g,G,"ref",s.props);if(p.tag==="Just"){if(p._1.tag==="Ref"){let f=p._1._1(Uo("Removed",n));return f.tag==="Just"?t(f._1)():void 0}return void 0}return void 0},a=s=>(p,f,d)=>{if(d.tag==="Attribute"){let c=(()=>{if(d._1.tag==="Nothing")return null;if(d._1.tag==="Just")return d._1._1;$()})();return Cr(c,d._2,d._3,n),d}if(d.tag==="Property")return Zt(d._1,d._2,n),d;if(d.tag==="Handler"){if(Ao(d._1,s))return Me(d._1,s)._2.value=d._2,d;let c={value:d._2},u=mn(l=>()=>{let e=c.value,i=e(l);return i.tag==="Just"?t(i._1)():void 0})();return Zt(d._1,W(u,c),s),xo(d._1,u,n),d}if(d.tag==="Ref"){let c=d._1(Uo("Created",n));return(()=>c.tag==="Just"?t(c._1):()=>void 0)()(),d}$()},o=(s,p)=>{let f=nn(),d=Mn(s.props,p,Ho,(c,u,l,e)=>{if(l.tag==="Attribute")return e.tag==="Attribute"&&(l._3===e._3||Cr((()=>{if(e._1.tag==="Nothing")return null;if(e._1.tag==="Just")return e._1._1;$()})(),e._2,e._3,n)),e;if(l.tag==="Property")return e.tag==="Property"?Ue(l._2,e._2)?e:e._1==="value"?(Ue(Me("value",n),e._2)||Zt(e._1,e._2,n),e):(Zt(e._1,e._2,n),e):e;if(l.tag==="Handler"){if(e.tag==="Handler"){let i=Me(e._1,s.events);return i._2.value=e._2,Zt(e._1,i,f),e}return e}return e},(c,u)=>{if(u.tag==="Attribute")return Ar((()=>{if(u._1.tag==="Nothing")return null;if(u._1.tag==="Just")return u._1._1;$()})(),u._2,n);if(u.tag==="Property")return qs(u._1,n);if(u.tag==="Handler")return So(u._1,Me(u._1,s.events)._1,n);if(u.tag==="Ref")return void 0;$()},a(f));return ut(void 0,{events:f,props:d},o,r)};return s=>{let p=nn(),f=An(s,Ho,a(p));return ut(void 0,{events:p,props:f},o,r)}};var xs=(t,n)=>Ue(t._1,n._1)&&Ue(t._2,n._2)&&t._2(t._4,n._4);var ko=t=>{let n=(r,a)=>{if(xs(r.thunk,a))return ut(r.vdom._1,r,n,p=>wt(p.vdom));let o=t(a._3(a._4)),s=vt(r.vdom,o);return ut(s._1,{vdom:s,thunk:a},n,p=>wt(p.vdom))};return r=>a=>{let o=t(a._3(a._4)),s=xn(r)(o);return ut(s._1,{thunk:a,vdom:s},n,p=>wt(p.vdom))}};var te=function(t){return function(n){return function(){return n[t]}}};var bD=te("baseURI"),Rs=te("ownerDocument"),Sn=te("parentNode"),Os=te("parentElement");var TD=te("childNodes"),Ps=te("firstChild"),Js=te("lastChild"),zs=te("previousSibling"),wr=te("nextSibling"),Us=te("nodeValue");var LD=te("textContent");function Bo(t){return function(n){return function(r){return function(){r.insertBefore(t,n)}}}}function Ir(t){return function(n){return function(){n.appendChild(t)}}}function Go(t){return function(n){return function(){n.removeChild(t)}}}var Qs=ht(zt)(Rt),Ws=t=>t,ks=t=>n=>r=>{if(r.tag==="Just"){if(n.tag==="Just"){let a=Bo(t)(n._1)(r._1);return()=>(a(),void 0)}if(n.tag==="Nothing"){let a=Ir(t)(r._1);return()=>(a(),void 0)}return()=>void 0}return()=>void 0},Vo=t=>{let n=Sn(t.node);return()=>{let r=n();return Qs(a=>Go(t.node)(a))(Xt(r,g,G))()}},vs=t=>n=>r=>({buildWidget:a=>{let o=ko(lt)(a),s=d=>{let c=n.value,u=c(d)();return ut(u.node,g,f,l=>l.tag==="Just"?wt(l._1):void 0)},p=d=>{if(d.tag==="ComponentSlot")return s(d._1);if(d.tag==="ThunkSlot"){let c=o(d._1);return ut(c._1,A("Just",c),f,u=>u.tag==="Just"?wt(u._1):void 0)}$()},f=(d,c)=>{if(d.tag==="Just"){if(c.tag==="ComponentSlot")return wt(d._1),s(c._1);if(c.tag==="ThunkSlot"){let u=vt(d._1,c._1);return ut(u._1,A("Just",u),f,l=>l.tag==="Just"?wt(l._1):void 0)}$()}return p(c)};return p},buildAttributes:Qo(t),document:r}),Bs=t=>n=>({render:r=>a=>o=>s=>{if(s.tag==="Nothing")return()=>{let p={value:a},f=xn(vs(r)(p)(t))(o);return Ir(f._1)(n)(),{machine:f,node:f._1,renderChildRef:p}};if(s.tag==="Just")return()=>{s._1.renderChildRef.value=a;let p=Sn(s._1.node)(),f=wr(s._1.node)(),d=vt(s._1.machine,o),c=ks(d._1)(Xt(f,g,G))(Xt(p,g,G));return(()=>Ce(s._1.node)(d._1)?()=>void 0:c)()(),{machine:d,node:d._1,renderChildRef:s._1.renderChildRef}};$()},renderChild:Ws,removeChild:Vo,dispose:Vo}),jo=t=>n=>r=>b(N((()=>{let a=It(Se)(Ye);return()=>a()})()))(a=>Co(Bs(a)(r))(t)(n));var qr=ht(Ze)(Rt);var Yo=t=>n=>{if(n.tag==="Initialize"){let r=qr(t.handleAction)(t.initialize);return Tt(r._1,Ot(r._2)(kt("CatCons",a=>Tt(Kt("Return",n._1),Wt),xt(w,w))))}if(n.tag==="Finalize"){let r=qr(t.handleAction)(t.finalize);return Tt(r._1,Ot(r._2)(kt("CatCons",a=>Tt(Kt("Return",n._1),Wt),xt(w,w))))}if(n.tag==="Receive"){let r=qr(t.handleAction)(t.receive(n._1));return Tt(r._1,Ot(r._2)(kt("CatCons",a=>Tt(Kt("Return",n._2),Wt),xt(w,w))))}if(n.tag==="Action"){let r=t.handleAction(n._1);return Tt(r._1,Ot(r._2)(kt("CatCons",a=>Tt(Kt("Return",n._2),Wt),xt(w,w))))}if(n.tag==="Query"){let r=n._2(void 0),a=t.handleQuery(n._1._2);return Tt(a._1,Ot(a._2)(kt("CatCons",o=>Tt(Kt("Return",(()=>{if(o.tag==="Nothing")return r;if(o.tag==="Just")return n._1._1(o._1);$()})()),Wt),xt(w,w))))}$()};var Xo={handleAction:t=>Tt(Kt("Return",void 0),Wt),handleQuery:t=>Tt(Kt("Return",g),Wt),receive:t=>g,initialize:g,finalize:g};var ed=t=>se("Elem",g,"div",[],[se("Text","Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non proident, sunt in culpa qui officia deserunt mollit anim id est laborum.")]),nd=t=>({}),Zo={initialState:nd,render:ed,eval:Yo(Xo)};var ti=Da(b(ya)(t=>jo(Zo)(void 0)(t)));ti();})();
